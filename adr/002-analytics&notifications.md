# ADR-002: Асинхронное взаимодействие для Аналитики и Уведомлений
* Дата: 05.02.2026
* Статус: Принято
* Контекст:  
​Analytics Service должен обрабатывать массивные данные телеметрии и создавать отчеты. Notification & Promo Service должен реагировать на события (успехи друзей, новые товары). Синхронное ожидание обработки данных аналитикой ухудшит пользовательский опыт (UX).  
* Опции:  
- Синхронный REST/gRPC (Request/Response)  
​Сценарий: Пользователь закончил бег -> Приложение вызывает API -> API вызывает Аналитику -> Ждет расчета -> Возвращает ответ.  
​Минусы: Высокая задержка. Если сервис аналитики перегружен или недоступен, пользователь не может сохранить тренировку.  
- Асинхронный обмен сообщениями (Event-Driven через Message Broker)  
​Сценарий: Приложение сохраняет тренировку -> Сервис публикует событие TRAINING_COMPLETED. Analytics Service подписывается, считает статистику. Notification Service подписывается, отправляет пуш.  
​Плюсы: Слабая связность (Decoupling). Система отзывчива. Возможность повторной обработки событий.  
* Принятое решение:  
​Использовать Event-Driven подход с брокером сообщений (Apache Kafka).  
* ​Обоснование:
- ​Это критично для требований производительности. Обработка биометрии и сравнение с прошлыми результатами — ресурсоемкая операция. Асинхронность гарантирует, что пользователь мгновенно получит подтверждение сохранения, а аналитика и подбор промоакций пройдут в фоне.
